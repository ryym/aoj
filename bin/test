#!/usr/bin/env bash

target=$(cat ./.target)
target=${1:-$target}
testfile="${target%%.*}.t.sh"

if [ ! -f .target ]; then
    echo ERROR: Please specify the test target by bin/cht.
    exit 1
fi

bin/compile $target

if [ $? -eq 1 ]; then
    exit 1
fi

./$testfile bin/run $target
